{
  "version": 3,
  "sources": ["../../javascript/packs/batch_connect_sessions.js"],
  "sourcesContent": ["'use strict';\n\nconst pollers = [];\n\nclass Timer {\n  constructor(callback, delay){\n    this.delay = delay;\n    this.remaining = delay;\n    this.active = true;\n    this.callback = callback;\n\n    this.resume();\n  }\n\n  resume() {\n    if(!this.active) { return; }\n\n    this.start = new Date();\n    this.clearTO();\n    this.timerId = setTimeout(this.callback, this.remaining);\n  }\n\n  restart() {\n    if(!this.active) { return; }\n\n    this.remaining = this.delay;\n    resume();\n  }\n\n  pause() {\n    if(!this.active) { return; }\n\n    this.clearTO();\n    this.remaining -= new Date() - this.start;\n  }\n\n  stop(){\n    if(!this.active) { return; }\n    this.clearTO();\n    this.active = false;\n  }\n\n  clearTO(){\n    if(this.timerId !== undefined) {\n      clearTimeout(this.timerId);\n    }\n  }\n\n}\n\nclass Poller {\n  constructor(url, delay) {\n    this.url = url;\n    this.delay = delay;\n    this.poll();\n  }\n\n  poll(){\n    this.timer = new Timer(this.request.bind(this), this.delay);\n  }\n\n  pause() {\n    this.timer.pause();\n  }\n\n  resume() {\n    this.timer.resume();\n  }\n\n  request(){\n    const that = this;\n    $.getScript(this.url)\n      .done((_script, _textStatus, _jqxhr) => {\n        return;\n      }).fail((_jqxhr, textStatus, errorThrown) => {\n        if(textStatus) { console.log(`Failed to get session data. Server returned '${textStatus}'`); }\n        if(errorThrown) { \n          console.log(\"Failed to get session data because of error.\");\n          console.log(errorThrown);\n        }\n        return;\n      }).always(() => {\n        that.poll();\n        return;\n      });\n  }\n}\n\nfunction makePollers(){  \n  const obj = $('#batch_connect_sessions');\n  if(!obj) return;\n\n  const url = obj.data('url');\n  const delay = obj.data('delay');\n  if(url && delay) { pollers.push(new Poller(url, delay)); }\n\n  $(document)\n    .on('show.bs.modal', () => {\n      pollers.forEach((poller) => {\n        poller.pause();\n      });\n    }).on('hidden.bs.modal', () => {\n    pollers.forEach((poller) => {\n      poller.resume();\n    });\n  });\n}\n\nfunction settingKey(id) {\n  return id + '_value';\n}\n\nfunction storeSetting(event) {\n  var key = settingKey(event.currentTarget.id);\n  var value = event.currentTarget.value;\n\n  localStorage.setItem(key, value);\n}\n\nfunction tryUpdateSetting(name) {\n  var saved_value = localStorage.getItem(settingKey(name));\n\n  if(saved_value) {\n    var selector = 'input[type=\"range\"][name=\"' + name + '\"]';\n    $(selector).val(saved_value);\n  }\n}\n\nfunction installSettingHandlers(name) {\n  var selector = 'input[type=\"range\"][name=\"' + name + '\"]';\n  $(selector).on('change', function(event){\n    storeSetting(event);\n  });\n}\n\nwindow.installSettingHandlers = installSettingHandlers;\nwindow.tryUpdateSetting = tryUpdateSetting;\n\njQuery(function() {\n  makePollers();\n});\n"],
  "mappings": "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",
  "names": []
}
