<%= javascript_pack_tag 'files/clipboard' %>
<%= javascript_pack_tag 'files/datatable' %>
<%= javascript_pack_tag 'files/common' %>
<%= javascript_pack_tag 'files/fileops' if filesApp == true %>
<%= javascript_pack_tag 'files/uppy' if filesApp == true %>

<script>
const csrf_token = document.querySelector('meta[name="csrf-token"]').content;
const filesApp = '<%= filesApp %>';
const filesUploadPath = '<%= files_upload_path %>';
const maxFileSize = <%= Configuration.file_upload_max %>;
const filesPath = "<%= files_path('/') %>";
const transfersPath = '<%= transfers_path(format: "json") %>';
// this uses event delegation so it captures events even if dom element is recreated
var clipboardjs = new ClipboardJS('#copy-path');

// contains ruby, must stay here.
history.replaceState({
  currentDirectory: '<%= @path %>',
  currentDirectoryUrl: '<%= files_path(@path) %>',
  currentDirectoryUpdatedAt: '<%= Time.now.to_i %>'
}, null);

// contains ruby, must stay here.
<% unless alert %>
// initial data load
reloadTable();
<% end %>

</script>
