<%-
  field_id = "#{form.object_name}_#{attrib.id}"
-%>

<div class="editable-form-field">
<% if field_id.match?('auto_environment_variable') %>
  <label>Name</label>
  <input class="form-control edit-field"
       type="text"
       data-auto-environment-variable="name"
       data-label-string=<%= attrib.original_label.gsub(' ', '&#32;').force_encoding('utf-8') %>
       value=<%= attrib.id.gsub(/auto_environment_variable_?/, '') %>
  >
<% end %>
  <%=  create_widget(form, attrib, format: format, hide_fixed: false) %>

<% if field_id.match?('auto_environment_variable') %>
  <%- port_type_value = attrib.respond_to?(:port_type) ? attrib.port_type : 'none' -%>
  <div class="port-type-group mt-3 mb-3">
    <label class="form-label fw-bold">Port Type</label>
    <div class="d-flex gap-3">
      <div class="form-check">
        <input class="form-check-input" type="radio"
               name="<%= form.object_name %>[<%= attrib.id %>_port_type]"
               id="<%= field_id %>_port_type_none" value="none"
               <%= port_type_value == 'none' ? 'checked' : '' %>>
        <label class="form-check-label" for="<%= field_id %>_port_type_none">None</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio"
               name="<%= form.object_name %>[<%= attrib.id %>_port_type]"
               id="<%= field_id %>_port_type_input_port" value="input_port"
               <%= port_type_value == 'input_port' ? 'checked' : '' %>>
        <label class="form-check-label" for="<%= field_id %>_port_type_input_port">Input Port</label>
      </div>
      <div class="form-check">
        <input class="form-check-input" type="radio"
               name="<%= form.object_name %>[<%= attrib.id %>_port_type]"
               id="<%= field_id %>_port_type_output_port" value="output_port"+               <%= port_type_value == 'output_port' ? 'checked' : '' %>>
        <label class="form-check-label" for="<%= field_id %>_port_type_output_port">Output Port</label>
      </div>
    </div>
  </div>
<% end %>

  <div class="d-none edit-group mb-3">
    <%= render(partial: 'launchers/editable_form_fields/edit_fixed_field',  locals: { form: form, attrib: attrib, fixed: fixed }) %>
  </div>

  <%= render(partial: 'launchers/editable_form_fields/edit_field_buttons', locals: { field_id: field_id }) %>
</div>
