name: Create Document issue for Merge Request

# Run this action when we merge into master
on:
  pull_request:
    branches:
      - main
    types: [closed]

jobs:
  # Create an issue on the documentation repository to document whatever was just pulled in.
  create-doc-issue:
    runs-on: ubuntu-latest
    if: github.event.pull_request.merged == true
    steps:
      - uses: actions/checkout@v2
      - name: Check for 'needs doc' label
        run: |
          PR_NUM={{ github.event.pull_request.number }}
          LABELS=$(curl https://github.com/johrstrom/ondemand/issues/$PR_NUM | | jq '.labels[].name)
          echo $LABELS

      # - name: Create an issue on the documentation repository
      #   run: |
      #     TITLE="Create Docs for "
      #     BODY="{
      #        \"title\": \"$TITLE\",
      #        \"body\": \"Create documentation for https://github.com/OSC/ondemand/commit/$GITHUB_SHA\"
      #     }"

      #     curl --silent --output /dev/null --request POST \
      #     --url https://api.github.com/repos/OSC/ood-documentation/issues \
      #     --header 'Authorization: token ${{ secrets.OSCWIAG_ISSUE_TOKEN }}' \
      #     --header 'content-type: application/json' \
      #     --data "$BODY"
